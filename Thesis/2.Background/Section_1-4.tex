\section{Scientific Codes}

In this section, I introduce the scientific codes that I coupled together in order to simulate the evolution of my target system.  Because these codes can be used in a variety of astrophysical scenarios, I will concentrate on their fundamental usage and working principles. I encourage users who want to dig deeper into the codes to follow the relevant citations.

\subsection{MESA}

MESA (Modules for Experiments in Stellar Astrophysics, \cite{paxton2010modules,paxton2013modules,paxton2015modules,paxton2019modules}) is a powerful and versatile 1D stellar evolution code that has become one of the most widely used tools in modern astrophysics. The code is designed to solve the fully coupled structure and composition equations simultaneously, allowing for highly accurate and detailed models of stars. MESA is written in Fortran and is developed and maintained by a large international collaboration of scientists.

MESA includes a wide range of physics modules for various astrophysical processes, such as the equation of state, nuclear reaction networks, hydrodynamics, convective and radiative energy transport, mass loss, rotation, and magnetic fields. The code can simulate the evolution of stars from their birth to their death, including complex phases such as helium and carbon burning, thermal pulses, and supernova explosions. As a result, MESA is an invaluable tool for astrophysical research, from studying the formation and evolution of stars to exploring the origins of the elements in the universe.

The central feature of MESA is the solution of the coupled structure and composition equations, which describe the internal structure of stars and the evolution of their chemical composition over time. These equations are based on fundamental principles of stellar physics, such as conservation of mass, momentum, and energy, as well as nuclear reactions that generate and consume energy in the star. The structure and composition equations can be written as a set of coupled differential equations that describe the evolution of the mass, radius, luminosity, temperature, and chemical composition of the star over time.

MESA also includes a comprehensive nuclear reaction network that describes the fusion of light elements into heavier elements in the stellar core. The network includes thousands of nuclear reactions that involve hundreds of isotopes, making it one of the most detailed and accurate nuclear reaction networks available for stellar evolution calculations.


\subsection{Gadget-2}

Gadget-2 (GAlaxies with Dark matter and Gas intEracT) is a smoothed particle hydrodynamics (SPH) code that simulates the gravitational and hydrodynamic evolution of collisionless and gaseous systems in astrophysical contexts. \citep{springel2005cosmological}. The code is capable of modeling a wide range of physical processes, such as gas dynamics, gravity, magnetic fields, and radiative transfer. Gadget-2 is written in C++ and is publicly available under the GNU General Public License.

The basic principle of the SPH method is to represent the fluid as a set of particles with associated physical attributes such as density, pressure, and velocity. To calculate these properties at a given point in space, the code uses a cubic spline kernel \citep{monaghan1985refined}, that is smooth and has a compact support, meaning it averages the properties of neighboring particles within a certain radius of the target point. Furthermore, the method is Lagrangian, meaning that the particles move with the fluid and do not have a fixed position in space.


The hydrodynamics computation in Gadget-2 is performed by solving the equations of motion for each particle in the simulation domain. The acceleration of each particle is calculated by summing the forces acting on it, including gravity, pressure gradients, and artificial viscosity. The gravity calculation uses the hybrid TreePM method \citep{bode2000tree,bagla2002treepm}, where the simulation volume is recursively subdivided into cubic cells, with each cell containing a maximum number of particles. The algorithm then builds a tree structure where each cell is treated as a node, and nodes that are spatially close are grouped together to form larger nodes. The final tree structure is used to compute the gravitational force on each particle avoiding the need to calculate the force between all pairs of particles in the system. This method reduces the computational cost from $O(N^2)$ for direct summation to $O(N\log N)$, where $N$ is the number of particles.


The code also includes modules for modeling magnetic fields and radiative transfer. The magnetic field module includes algorithms for calculating the magnetic field evolution and its effects on the gas dynamics. The radiative transfer module includes algorithms for calculating the transport of radiation through the simulation domain and its effects on the gas and dust properties. Gadget-2 can be run in parallel on high-performance computing clusters using the Message Passing Interface (MPI) standard.


\subsection{Huayno}

Huayno \citep{pelupessy2012n} is a high-performance N-body integrator code designed to simulate the dynamics of collisionless systems, such as galaxies, star clusters, and dark matter halos. The code is publicly available under the GNU General Public License and is written in C++. Similar with Gadget-2, the basic principle of Huayno is to use a hybrid algorithm \citep{bode2000tree} that combines the particle-mesh (PM) \citep{klypin1983three} and tree-based algorithms \citep{barnes1986hierarchical,dehnen2000very} to reduce the computational cost of simulating large systems.


The PM algorithm represents the gravitational potential as a discrete mesh of fixed resolution, and the particle positions are interpolated onto the mesh using a cloud-in-cell (CIC) scheme. The gravitational forces are then calculated by solving Poisson's equation on the mesh. The tree-based algorithm, on the other hand, uses a hierarchical structure to group particles into clusters and calculates the forces between clusters at different levels of the hierarchy. By combining the advantages of both algorithms, Huayno can handle a wide range of particle distributions and non-equilibrium systems, such as systems with binary or multiple stars.


Huayno also includes various subroutines and modules to facilitate the user in setting up simulations for different astrophysical scenarios. For example, the user can specify the initial conditions of the system, such as particle positions, velocities, masses, and physical properties. The user can also specify the boundary conditions of the simulation domain, such as periodic, reflecting, or outflow boundaries.

The code is designed to handle a wide range of particle distributions, from homogeneous and isotropic systems to anisotropic and structured systems. Huayno can also handle non-equilibrium systems, such as systems with binary or multiple stars. The user can specify the softening length of the gravitational interaction, which determines the spatial extent of the smoothing. The code also includes modules for integrating the orbits of particles, calculating the energy and angular momentum of the system, and analyzing the simulation output.

Huayno is designed to run efficiently on modern high-performance computing (HPC) clusters, and it supports parallel computing using the Message Passing Interface (MPI) standard. The code is optimized for a wide range of hardware architectures, including multi-core processors, GPUs, and FPGAs. The user can specify the number of processors or cores to use for the simulation, as well as the communication and load-balancing strategies.

In summary, Huayno is a powerful N-body integrator code that combines the PM and tree-based algorithms to simulate the dynamics of collisionless systems. The code is highly customizable and can handle a wide range of astrophysical scenarios, from galaxy formation to dark matter halos. The user can specify the initial conditions and boundary conditions of the simulation, as well as the softening length and other parameters. Huayno is optimized for parallel computing and can run efficiently on a wide range of HPC clusters.


\subsection{AMUSE}

Astrophysical Multipurpose Software Environment (AMUSE) is an open-source software package designed for astrophysical simulations and data analysis \citep{pelupessy2013astrophysical,portegies2018astrophysical}. The software is written in Python, which provides a user-friendly interface, and allows users to combine multiple astrophysical codes into a single simulation. AMUSE consists of a collection of modules that can be used to simulate a wide range of astrophysical phenomena, including stellar evolution, gravitational dynamics, hydrodynamics, radiative transfer, and cosmology.

One of the unique features of AMUSE is its ability to couple different simulation codes and to integrate them into a single framework. This allows researchers to simulate complex astrophysical phenomena that cannot be studied using a single code or method alone \citep{pelupessy2013astrophysical,portegies2018astrophysical}. For example, AMUSE can simulate the evolution of a binary star system, including the dynamics of the stars, the evolution of their interiors, and the transfer of mass and angular momentum between them. AMUSE can also simulate the formation and evolution of a star cluster, including the dynamics of the stars, the gas dynamics, and the radiative feedback from the stars.

AMUSE provides a powerful and flexible tool for data analysis, allowing users to analyze large data sets and to extract meaningful scientific results \citep{portegies2018astrophysical}. The software includes modules for data visualization, data reduction, and data analysis, allowing users to extract information from simulations and observational data.

AMUSE is designed to be highly scalable and can be run on a range of computing platforms, from laptops to high-performance computing clusters \citep{pelupessy2013astrophysical}. The software is optimized for parallel computing, and users can run simulations on multiple cores or distributed computing clusters using the Message Passing Interface (MPI) standard.

In summary, AMUSE is a powerful and versatile software package for astrophysical simulations and data analysis. The software allows researchers to simulate a wide range of astrophysical phenomena and to combine different simulation codes into a single framework. AMUSE provides a user-friendly interface and is highly scalable, making it an essential tool for astrophysical research in the era of big data.

